---
title: "Photostrip Viewer"
format: html
---

```{=html}
<!-- Photostrip container styled to look like a classic photobooth strip -->
<div id="photostrip" style="width: 220px; margin: 20px auto; border: 1px solid black; background-color: #f0f0f0; padding: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
</div>

<!-- Button to trigger the download -->
<button id="download-button" style="display: block; margin: 20px auto; padding: 10px 20px;">Download Photostrip</button>

<!-- Invisible canvas for compiling images -->
<canvas id="canvas" style="display:none;"></canvas>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const images = JSON.parse(localStorage.getItem('photostripImages'));
    if (images && images.length) {
        const strip = document.getElementById('photostrip');
        images.forEach(src => {
            const img = document.createElement('img');
            img.src = src;
            img.style.width = '200px'; // Set width to fit the photostrip
            img.style.display = 'block'; // Stack images vertically
            img.style.marginBottom = '10px'; // Space between photos
            strip.appendChild(img);
        });

        createDownloadableImage(images);
    }
});

function createDownloadableImage(images) {
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = 220; // Width of the photostrip
    let yOffset = 0;

    images.forEach((src, index) => {
        const img = new Image();
        img.onload = function() {
            if (index === 0) {
                canvas.height = (img.height + 10) * images.length - 10; // Calculate total height with spacing
            }
            ctx.drawImage(img, 10, yOffset); // Center the image with some padding
            yOffset += img.height + 10; // Move to the next position with spacing
            if (index === images.length - 1) {
                document.getElementById('download-button').onclick = function() {
                    const dataURL = canvas.toDataURL('image/png');
                    const link = document.createElement('a');
                    link.download = 'photostrip.png';
                    link.href = dataURL;
                    link.click();
                };
            }
        };
        img.src = src;
    });
}
</script>
```